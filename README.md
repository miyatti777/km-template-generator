# KM テンプレートジェネレーター

🧠 **VS Code Mind Map拡張機能用のマインドマップJSONファイルを生成し、LLMリクエストの構造化に活用**

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.7+](https://img.shields.io/badge/python-3.7+-blue.svg)](https://www.python.org/downloads/)

## ✨ 機能

- 🗺️ **マインドマップ構造**: 複雑なLLMリクエスト用の構造化JSONファイルを作成
- 📅 **自動整理**: 日付ベースのフォルダ構造で自動保存
- 🎯 **テンプレートベース**: すべてのLLMインタラクションで一貫した構造
- ⚡ **高速生成**: コマンドラインから数秒でテンプレート作成
- 🔧 **エディタ統合**: 作成したファイルを自動で好みのエディタで開く
- 🔄 **ユニークID**: 各テンプレートに一意の識別子とタイムスタンプを生成

## 🚀 クイックスタート

### 📦 自動インストール（推奨）

1. **リポジトリをクローン**
   ```bash
   git clone <repository-url>
   cd km-template-generator
   ```

2. **インストールスクリプトを実行**
   ```bash
   ./install.sh
   ```
   
   このスクリプトが以下を自動で行います：
   - ✅ Pythonスクリプトをユーザー指定場所に配置
   - ✅ KMファイル出力先の設定
   - ✅ VS Code Tasks の設定（既存ファイルを安全に更新）
   - ✅ VS Code Mind Map拡張機能の手動インストール手順の案内

### 🔧 手動インストール

自動インストールが使えない場合：

1. **実行権限を付与**
   ```bash
   chmod +x km_template_generator.py
   ```

2. **VS Code Mind Map拡張機能をインストール**
   - **拡張機能名**: Mind Map
   - **ID**: `oorzc.mind-map`
   - **リンク**: [Open VSX](https://open-vsx.org/extension/oorzc/mind-map)

3. **手動でVS Code Tasksを設定**
   - プロジェクトルートに `.vscode/tasks.json` を作成
   - 詳細は `install.sh` の内容を参照

### 🚀 使用開始

1. **VS Code でコマンドパレットを開く** (`Cmd+Shift+P` / `Ctrl+Shift+P`)
2. **"Tasks: Run Task"** を選択
3. **"Create KM Template"** を選択
4. **依頼タイトルを入力** (例: "データ分析の手伝い")
5. **自動でKMファイルが作成され、エディタで開かれます**

※ 実行方法は VS Code の "Tasks: Run Task" のみをサポートします（その他の方法は非推奨）
これで VS Code から簡単にKMテンプレートを作成できます！

## 📋 KMファイルとは？

KMファイルは**VS Code Mind Map拡張機能用のマインドマップ表示形式**（JSON）です。本来はマインドマップの可視化のためのファイル形式ですが、このツールでは**LLMへの依頼を構造化して整理する**目的で活用しています。

### 活用方法
- **メインリクエスト**: 主要なタスクや質問
- **コンテキスト**: 背景情報と制約
- **詳細指示**: ステップバイステップの要件
- **ファイルパス**: 関連するディレクトリとファイル
- **追加メモ**: その他の情報

### 構造例

```json
{
    "root": {
        "data": {
            "id": "unique_id_here",
            "created": 1234567890123,
            "text": "メインリクエスト: ユーザー行動データを分析"
        },
        "children": [
            {
                "data": {
                    "id": "context_id",
                    "created": 1234567890124,
                    "text": "コンテキスト: 日次1万ユーザーのECサイト"
                },
                "children": []
            },
            {
                "data": {
                    "id": "instructions_id",
                    "created": 1234567890125,
                    "text": "詳細指示"
                },
                "children": [
                    {
                        "data": {
                            "id": "step1_id",
                            "created": 1234567890126,
                            "text": "1. CSVファイルからデータを読み込み"
                        },
                        "children": []
                    }
                ]
            }
        ]
    },
    "template": "filetree",
    "theme": "fresh-blue",
    "version": "1.4.43"
}
```

## 🎯 推奨ワークフロー「ビジュアル構造化依頼法」

VS Code Mind Map拡張機能の**KMファイル（マインドマップ形式）を活用**して、LLMへの依頼を構造化する**推奨ワークフロー**をご紹介します。本来のマインドマップ機能を使って、XMLライクな構造化された依頼をビジュアルで考えながら作成できます。

### 🚀 完全ワークフロー

```
1. KMテンプレート生成 → 2. ビジュアル編集 → 3. Export Node → 4. LLM依頼
   ⬇️                    ⬇️                  ⬇️              ⬇️
   基本構造作成           思考整理・拡張        構造化テキスト    XMLライク依頼
```

### 📋 ステップバイステップガイド

#### **Step 1: KMテンプレート生成**
```bash
# このツールでKMファイルを生成
create-km "データ分析の手伝い"
```

#### **Step 2: VS Code Mind Map拡張機能のインストール**
- **Cursor/VS Code拡張機能**: [oorzc.mind-map](https://open-vsx.org/extension/oorzc/mind-map)
- **インストール後**: `.km`ファイル（マインドマップ形式のJSON）が自動でビジュアルなマインドマップとして開かれる

#### **Step 3: ビジュアル編集で思考整理**
1. **マインドマップビューで編集**
   - ノードの追加・削除・移動
   - 階層構造の調整
   - 関連性の視覚化

2. **思考の拡張**
   - 「コンテキスト」ノードに背景情報を追加
   - 「詳細指示」に具体的な手順を記述
   - 「出力形式」に期待する結果を明記

3. **複雑な関係性も直感的に整理**
   - ドラッグ&ドロップで簡単に構造変更
   - ビジュアルで全体像を把握

#### **Step 4: Export Node機能で構造化テキスト生成**
1. **右クリックまたはコマンドパレット**から「Export Node」を実行
2. **インデントされた構造化テキスト**が自動生成される
3. **XMLライクな階層構造**でコピー可能

#### **Step 5: LLMチャットに貼り付けて依頼**
```
依頼：データ分析の手伝い
    コンテキスト：
        日次1万ユーザーのECサイト
        過去3ヶ月のユーザー行動データ
        売上向上が目的
    詳細指示
        1. CSVファイルからデータを読み込み
        2. ユーザー行動パターンを分析
        3. 売上との相関関係を調査
        4. 改善提案を作成
    出力形式・成果物
        分析レポート（PDF）
        可視化グラフ（PNG）
        改善提案書（Markdown）
    補足・その他
        Python/Pandasを使用
        期限：1週間以内
```

### 🎨 従来手法との比較

| 従来の方法 | 新しいビジュアル構造化依頼法 |
|-----------|---------------------------|
| 手書きXML構造 | ビジュアルマインドマップ |
| 線形的な思考 | 放射状・階層的思考 |
| 構造が見えにくい | 関係性が一目瞭然 |
| 修正が面倒 | ドラッグ&ドロップで簡単 |
| 重いソフト必要 | VS Code内で完結 |
| 思考が制限される | 自由な発想・連想が可能 |

### 💡 実際の活用例

#### **データ分析プロジェクト**
1. **KM生成**: 「売上データ分析」
2. **ビジュアル整理**: 
   - データソース（CSV、API、DB）
   - 分析手法（統計、機械学習、可視化）
   - 出力形式（グラフ、レポート、ダッシュボード）
   - 制約条件（期限、ツール、精度要件）
3. **Export**: 構造化された分析依頼
4. **LLM実行**: 「以下の構造で分析をお願いします」

#### **コードレビュープロジェクト**
1. **KM生成**: 「認証システムレビュー」
2. **ビジュアル整理**:
   - レビュー対象（ファイル、モジュール）
   - チェック項目（セキュリティ、パフォーマンス、可読性）
   - 出力形式（レポート、修正提案）
   - 優先度（高、中、低）
3. **Export**: 構造化されたレビュー依頼
4. **LLM実行**: 体系的なコードレビュー

### 🚀 この手法の革新性

- **🧠 思考の可視化**: VS Code Mind Map拡張機能を使って複雑な依頼内容を視覚的に整理
- **🔄 柔軟な編集**: マインドマップの特性を活かし、思考の変化に合わせて構造を自由に変更
- **📤 自動構造化**: Mind Map拡張機能のExport Node機能で手間なく構造化テキスト生成
- **⚡ 高速ワークフロー**: VS Code内で完結、重いマインドマップソフト不要
- **🎯 精度向上**: 本来のマインドマップ機能を活用した丁寧なコンテキストでLLMの回答品質が向上

### 🎯 高度なテクニック

#### **複数の依頼を並行管理**
- 複数のKMファイルを同時に開いて、プロジェクト全体を俯瞰
- タブ機能で簡単に切り替え
- 関連する依頼同士をリンクして管理

#### **テンプレートの再利用**
- よく使う構造をテンプレート化
- プロジェクトタイプ別のベストプラクティスを蓄積
- チーム内での標準化

#### **段階的な依頼の詳細化**
1. **第1段階**: 大まかな構造で概要を依頼
2. **第2段階**: LLMの回答を受けて詳細を追加
3. **第3段階**: さらに具体的な実装依頼

### 🔧 トラブルシューティング

#### **拡張機能が動作しない場合**
1. VS Code/Cursorの再起動
2. 拡張機能の再インストール
3. `.km`ファイルの関連付け確認

#### **Export Nodeが見つからない場合**
1. 右クリックメニューを確認
2. コマンドパレット（Ctrl/Cmd+Shift+P）から「Export」で検索
3. 拡張機能のバージョン確認

#### **構造化テキストが期待通りでない場合**
1. マインドマップの階層構造を見直し
2. ノードのテキスト内容を調整
3. 不要なノードを削除

## 📁 ファイル整理

ジェネレーターは自動で日付ベースの構造でファイルを整理します：

```
Flow/
├── 202409/              # 年月フォルダ
│   └── 2024-09-22/      # 日付フォルダ
│       ├── task1.km     # その日の最初のテンプレート
│       ├── task2.km     # 2番目のテンプレート
│       └── task3.km     # 以下同様...
└── 202410/
    └── 2024-10-01/
        └── task1.km
```

## 🔧 設定

### カスタムFlowディレクトリ

デフォルトでは `Flow/YYYYMM/YYYY-MM-DD/` に保存されます。スクリプトを修正してカスタマイズできます：

```python
# km_template_generator.py 内
FLOW_BASE_DIR = "/your/custom/path/Flow"
```


## 📋 テンプレートカスタマイズ

### テンプレート構造の変更

`create_km_template()` 関数を編集してデフォルトのテンプレート構造をカスタマイズできます：

```python
def create_km_template(title):
    return {
        "root": {
            "data": {
                "id": generate_unique_id(),
                "created": int(time.time() * 1000),
                "text": f"依頼: {title}"  # ここをカスタマイズ
            },
            "children": [
                # カスタム構造をここに追加
            ]
        },
        "template": "filetree",
        "theme": "fresh-blue",  # テーマ変更
        "version": "1.4.43"
    }
```

### 利用可能テーマ

- `fresh-blue` (デフォルト)
- `classic`
- `dark`
- `colorful`

## 🔧 必要環境

- **Python 3.7+**
- **追加パッケージ不要**（標準ライブラリのみ使用）

## 📁 プロジェクト構成

```
km-template-generator/
├── km_template_generator.py    # メインスクリプト
├── create_km.sh               # シェルラッパー
├── install.sh                 # インストーラー（Tasks設定を自動適用）
├── README.md               # 日本語版README（このファイル）
└── LICENSE                    # MITライセンス
```

## 🐛 トラブルシューティング

### よくある問題

1. **"Permission denied"**
   ```bash
   chmod +x km_template_generator.py
   ```

2. **エディタが開かない**
   - VS Codeをインストールし、`code` コマンドが利用可能であることを確認
   - または好みのエディタを使用するようスクリプトを修正

3. **"Flow directory not found"**
   - スクリプトが自動でディレクトリ構造を作成します
   - 対象場所のファイル権限を確認

### デバッグモード

スクリプトは以下の詳細出力を提供：
- 作成されたファイルパス
- ディレクトリ作成ステップ
- エディタ開く試行

## 🤝 コントリビューション

1. リポジトリをフォーク
2. フィーチャーブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## 📄 ライセンス

このプロジェクトは MIT ライセンスの下で公開されています - 詳細は [LICENSE](LICENSE) ファイルを参照してください。

## 🙏 謝辞

- 構造化思考のためのマインドマッピング技術にインスパイア
- 効率的なLLMインタラクションワークフローのために構築
- 複雑なリクエスト整理に最適

## 📞 サポート

- 🐛 **Issues**: [GitHub Issues](https://github.com/your-username/km-template-generator/issues)
- 💡 **機能リクエスト**: [GitHub Discussions](https://github.com/your-username/km-template-generator/discussions)
- 📧 **連絡先**: your-email@example.com

## 🔗 関連プロジェクト

- **[VS Code 動的タスクランナー](https://github.com/your-username/task-runner)**: このジェネレーターをコマンドラインから簡単に実行
- **[マインドマップビューア](https://github.com/topics/mindmap)**: 生成されたKMファイルを可視化するツール

---

⭐ **このリポジトリが役に立ったらスターをお願いします！** ⭐
